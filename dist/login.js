(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{180:function(e,r,t){"use strict";t.r(r);var s=t(228),i=t(188);for(var o in i)"default"!==o&&function(e){t.d(r,e,(function(){return i[e]}))}(o);t(217);var a=t(51),n=Object(a.a)(i.default,s.a,s.b,!1,null,"27539ebe",null);n.options.__file="components/login.vue",r.default=n.exports},188:function(e,r,t){"use strict";t.r(r);var s=t(189),i=t.n(s);for(var o in s)"default"!==o&&function(e){t.d(r,e,(function(){return s[e]}))}(o);r.default=i.a},189:function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var s={data:function(){var e=this,r=function(e,r,t){""===r?t(new Error("请输入账号")):/^\d{10}$/.test(r)?t():t(new Error("账号由10位数字组成"))},t=function(e,r,t){""===r?t(new Error("请输入密码")):/^[a-zA-Z0-9]+$/.test(r)?t():t(new Error("请输入由字母或数字组成的密码"))};return{loginShow:!0,form:{username:"",password:""},rules:{username:{validator:r,trigger:"blur"},password:{validator:t,trigger:"blur"}},registerForm:{username:"",password:"",confirmPassword:"",nickname:"",userPicture:null},registerRules:{username:{validator:r,trigger:"blur"},password:{validator:t,trigger:"blur"},confirmPassword:{validator:function(r,t,s){t!==e.registerForm.password?s(new Error("两次输入密码不一致")):s()},trigger:"blur"},nickname:{validator:function(e,r,t){""===r?t(new Error("请输入昵称")):/\s/.test(r)?t(new Error("昵称不能包含空格")):t()},trigger:"blur"}},imageUrl:"",fileList:[]}},methods:{login:function(e){var r=this;this.$refs[e].validate((function(e){if(!e)return r.$message({message:"账号或密码格式错误，请重新输入",type:"warning"}),!1;r.loginRequest()}))},loginRequest:function(){var e=this;this.$http.post("login",this.form).then((function(r){var t=r.data;t.loginSuccess?(e.$message({message:"登陆成功",type:"success"}),e.$store.commit("changeUserInfo",{userInfo:t.userInfo}),sessionStorage.setItem("login",!0),e.$router.push("/mainPage")):e.$message.error("账号或密码错误，登陆失败")})).catch((function(r){e.$message.error("连接服务器错误")}))},createImgUrl:function(e,r){this.imageUrl=URL.createObjectURL(r[0].raw),this.registerForm.userPicture=r[0].raw},handleRemove:function(){this.imageUrl="",this.registerForm.userPicture=null,this.fileList=[]},register:function(e){var r=this,t=this;this.$refs[e].validate((function(e){return e?(t.imgPass()&&r.registerRequest(),!1):(r.$message({message:"注册信息错误，请重新输入",type:"warning"}),!1)}))},registerRequest:function(){var e=this,r=new FormData;r.append("username",this.registerForm.username),r.append("password",this.registerForm.password),r.append("nickname",this.registerForm.nickname),r.append("userPicture",this.registerForm.userPicture),this.$http.post("register",r).then((function(r){r.data.registerSuccess?(e.$message({type:"success",message:"注册成功"}),e.form.username=e.registerForm.username,e.form.password=e.registerForm.password,e.$refs.registerForm.resetFields(),e.imageUrl="",e.registerForm.userPicture=null,e.fileList=[],e.loginShow=!0):e.$message.error("账号重复,注册失败")})).catch((function(r){e.$message.error("连接服务器错误")}))},imgPass:function(){if(null==this.registerForm.userPicture)return this.$message.error("请添加头像图片"),!1;var e="image/jpeg"===this.registerForm.userPicture.type||"image/png"===this.registerForm.userPicture.type,r=this.registerForm.userPicture.size/1024/1024<2;return e?r||this.$message.error("上传头像图片大小不能超过 2MB!"):this.$message.error("上传头像图片只能是 JPG 或 PNG 格式!"),e&&r}}};r.default=s},190:function(e,r,t){},217:function(e,r,t){"use strict";var s=t(190);t.n(s).a},228:function(e,r,t){"use strict";t.d(r,"a",(function(){return s})),t.d(r,"b",(function(){return i}));var s=function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("el-container",{ref:"rootContainer"},[t("el-header"),e._v(" "),t("el-main",[t("div",{attrs:{id:"head"}}),e._v(" "),t("div",{attrs:{id:"loginContainer"}},[t("transition",{attrs:{name:"loginxx",mode:"out-in"}},[e.loginShow?t("div",{key:"login",attrs:{id:"login"}},[t("el-form",{ref:"form",attrs:{rules:e.rules,model:e.form,"label-width":"80px"}},[t("el-form-item",[t("div",{staticClass:"topHead"},[e._v("Login")])]),e._v(" "),t("el-form-item",{attrs:{label:"账号",prop:"username"}},[t("el-input",{attrs:{placeholder:"请输入账号"},model:{value:e.form.username,callback:function(r){e.$set(e.form,"username",r)},expression:"form.username"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"密码",prop:"password"}},[t("el-input",{attrs:{type:"password",placeholder:"请输入密码"},model:{value:e.form.password,callback:function(r){e.$set(e.form,"password",r)},expression:"form.password"}})],1),e._v(" "),t("el-form-item",[t("el-button",{attrs:{type:"default"},on:{click:function(r){return e.login("form")}}},[e._v("登陆")]),e._v(" "),t("el-button",{attrs:{type:"info"},on:{click:function(r){e.loginShow?e.loginShow=!1:e.loginShow=!0}}},[e._v("注册")])],1)],1)],1):t("div",{key:"register",attrs:{id:"register"}},[t("el-form",{ref:"registerForm",attrs:{rules:e.registerRules,model:e.registerForm,"label-width":"80px"}},[t("el-form-item",[t("div",{staticClass:"topHead"},[e._v("Register")])]),e._v(" "),t("el-form-item",{attrs:{label:"账号",prop:"username"}},[t("el-input",{attrs:{placeholder:"请输入账号"},model:{value:e.registerForm.username,callback:function(r){e.$set(e.registerForm,"username",r)},expression:"registerForm.username"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"密码",prop:"password"}},[t("el-input",{attrs:{type:"password",placeholder:"请输入密码"},model:{value:e.registerForm.password,callback:function(r){e.$set(e.registerForm,"password",r)},expression:"registerForm.password"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"确认密码",prop:"confirmPassword"}},[t("el-input",{attrs:{type:"password",placeholder:"请再次输入密码"},model:{value:e.registerForm.confirmPassword,callback:function(r){e.$set(e.registerForm,"confirmPassword",r)},expression:"registerForm.confirmPassword"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"昵称",prop:"nickname"}},[t("el-input",{attrs:{type:"text",placeholder:"请输入昵称"},model:{value:e.registerForm.nickname,callback:function(r){e.$set(e.registerForm,"nickname",r)},expression:"registerForm.nickname"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"头像"}},[t("el-upload",{staticClass:"avatar-uploader",attrs:{action:"","on-change":e.createImgUrl,"auto-upload":!1,limit:1,"show-file-list":!1,"file-list":e.fileList}},[e.imageUrl?t("img",{staticClass:"avatar",attrs:{src:e.imageUrl},on:{click:function(r){return e.handleRemove()}}}):t("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),e._v(" "),t("el-form-item",[t("el-button",{attrs:{type:"default"},on:{click:function(r){return e.register("registerForm")}}},[e._v("注册")]),e._v(" "),t("el-button",{attrs:{type:"info"},on:{click:function(r){e.loginShow?e.loginShow=!1:e.loginShow=!0}}},[e._v("返回")])],1)],1)],1)])],1),e._v(" "),t("div",{attrs:{id:"logo"}},[t("i",{staticClass:"el-icon-video-camera"}),e._v(" "),t("span",[e._v("Movie")])])])],1)},i=[];s._withStripped=!0}}]);