(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{185:function(e,t,s){"use strict";s.r(t);var i=s(233),n=s(205);for(var o in n)"default"!==o&&function(e){s.d(t,e,(function(){return n[e]}))}(o);s(225);var r=s(51),a=Object(r.a)(n.default,i.a,i.b,!1,null,"e0b88d36",null);a.options.__file="components/movieDetailPage.vue",t.default=a.exports},205:function(e,t,s){"use strict";s.r(t);var i=s(206),n=s.n(i);for(var o in i)"default"!==o&&function(e){s.d(t,e,(function(){return i[e]}))}(o);t.default=n.a},206:function(e,t,s){"use strict";var i=s(14);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n={props:["id"],data:function(){return{movie:{id:"",movieimg:"",moviename:"",type:"",introduction:"",rate:0,moviesource:""},currentTime:0,comments:[],commentInput:"",activeClass:["icon"],commentLength:0,whichPage:1,playerShow:!1,showComment:!0}},computed:{imgurl:function(){return""!=this.movie.movieimg?this.$store.state.rotatePath+this.movie.imgname:""},value:{get:function(){return Number(this.movie.rate)},set:function(e){this.movie.rate=e}}},methods:{dianzhan:function(e,t,s){var i=this,n=this.$refs.svgArr[e],o=this.comments[e],r=this;1!=n.getAttribute("clickflag")&&(n.setAttribute("clickflag",1),t?this.$http.post("dianzhanComment",{action:"quxiaodianzhan",username:this.$store.state.userInfo.username,commentid:s.commentid}).then((function(e){if(e.data.success){n.setAttribute("class","icon quxiaodianzhananimateClass");var t=o.good-1;i.$set(o,"good",t),setTimeout((function(){r.$set(o,"havedianzhan",!1),n.setAttribute("clickflag",0)}),1e3)}else i.$message.error("取消点赞失败"),n.setAttribute("clickflag",0)})).catch((function(e){i.$message.error("取消点赞失败"),n.setAttribute("clickflag",0)})):this.$http.post("dianzhanComment",{action:"dianzhan",username:this.$store.state.userInfo.username,commentid:s.commentid}).then((function(e){if(e.data.success){n.setAttribute("class","icon animateClass orangeColor");var t=o.good+1;i.$set(o,"good",t),setTimeout((function(){r.$set(o,"havedianzhan",!0),n.setAttribute("clickflag",0)}),1e3)}else i.$message.error("点赞失败"),n.setAttribute("clickflag",0)})).catch((function(e){i.$message.error("点赞失败"),n.setAttribute("clickflag",0)})))},publishComment:function(){var e=this;""==this.commentInput?this.$message({type:"warning",message:"请输入评论内容"}):this.$http.post("publishComment",{comment:this.commentInput,username:this.$store.state.userInfo.username,movieid:this.movie.id}).then((function(t){t.data.success?(e.$message({type:"success",message:"发表评论成功"}),e.commentInput="",e.comments=[],e.getCommentInfo()):e.$message.error("发表评论失败")})).catch((function(e){console.log(e.message)}))},getMovieInfo:function(){var e=this;this.$http.get("getMovieById",{params:{id:this.id}}).then((function(t){var s=t.data;s.success?(e.movie=s.movie,e.currentTime=s.history.currentTime):e.$message.error("获取电影数据失败")})).catch((function(t){e.$message.error("获取电影数据失败")}))},getCommentInfo:function(){var e=this;this.$http.post("getCommentsByMovieId",{id:this.id,username:this.$store.state.userInfo.username,whichPage:this.whichPage}).then((function(t){var s=t.data;s.success?(e.comments=s.data,e.commentLength=s.commentLength):e.$message.error("获取评论失败")})).catch((function(e){console.log(e)}))}},created:function(){this.getMovieInfo(),this.getCommentInfo()},components:{player:i(s(223)).default}};t.default=n},207:function(e,t,s){"use strict";s.r(t);var i=s(208),n=s.n(i);for(var o in i)"default"!==o&&function(e){s.d(t,e,(function(){return i[e]}))}(o);t.default=n.a},208:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i={props:["moviesource","historyCurrentTime","movieid"],data:function(){return{video:null,ispaused:!0,showTool:!1,out:null,isFull:!1,flag:null,playChangeFlag:null,currentTime:"00:00:00",showVolumn:!1,lastCurrentTime:!1}},methods:{gotoLastTime:function(){this.video.currentTime=this.historyCurrentTime,this.lastCurrentTime=!1,this.ispaused&&this.play()},showLastCurrentTime:function(){if(""!=this.historyCurrentTime){var e=this;this.lastCurrentTime=!0,setTimeout((function(){e.lastCurrentTime=!1}),1e4)}},controlShow:function(){var e=this;this.flag?(clearTimeout(this.flag),this.flag=setTimeout((function(){e.showTool=!1,e.flag=null}),3e3)):(this.showTool=!0,this.flag=setTimeout((function(){e.showTool=!1,e.flag=null}),3e3))},play:function(){this.video.paused?(this.video.play(),this.playChangePosition()):(this.video.pause(),clearInterval(this.playChangeFlag)),this.ispaused=!this.ispaused},enlarge:function(){var e=this.$refs.duration,t=this.$refs.currentTime;this.isFull?(this.exitFullscreen(),this.isFull=!1,e.style.bottom="4%",t.style.bottom="4%"):(this.launchFullscreen(this.out),this.isFull=!0,e.style.bottom="7%",t.style.bottom="7%"),this.playChangePosition()},launchFullscreen:function(e){if(e.requestFullscreen)e.requestFullscreen();else if(e.mozRequestFullScreen)e.mozRequestFullScreen();else if(e.msRequestFullscreen)e.msRequestFullscreen();else if(e.oRequestFullscreen)e.oRequestFullscreen();else if(e.webkitRequestFullscreen)e.webkitRequestFullScreen();else{var t=document.documentElement,s=document.body,i=document.getElementById("videobox"),n="width:100%;height:100%;overflow:hidden;";t.style.cssText=n,s.style.cssText=n,i.style.cssText=n+";margin:0px;padding:0px;",document.IsFullScreen=!0}},exitFullscreen:function(){if(document.exitFullscreen)document.exitFullscreen();else if(document.msExitFullscreen)document.msExitFullscreen();else if(document.mozCancelFullScreen)document.mozCancelFullScreen();else if(document.oRequestFullscreen)document.oCancelFullScreen();else if(document.webkitExitFullscreen)document.webkitExitFullscreen();else{var e=document.documentElement,t=document.body,s=document.getElementById("videobox");e.style.cssText="",t.style.cssText="",s.style.cssText="",document.IsFullScreen=!1}},changeProgress:function(){clearInterval(this.playChangeFlag),this.out.addEventListener("mousemove",this.progressPosition)},stopChangeProgress:function(){var e=this.out.offsetLeft+.15*this.out.clientWidth,t=this.$refs.transparentProgess.offsetWidth;this.out.removeEventListener("mousemove",this.progressPosition),this.video.currentTime=parseInt(this.video.duration*(event.screenX-e)/t),this.ispaused=!1,this.video.play(),this.playChangePosition()},progressPosition:function(){var e=this.out.offsetLeft+.15*this.out.clientWidth,t=this.$refs.transparentProgess.offsetWidth;event.screenX-e>0&&event.screenX-e<t&&(this.$refs.dragCircle.style.left="calc(".concat((event.screenX-e)/t*100,"% - 0.5rem)"),this.$refs.whiteProgess.style.width=event.screenX-e+"px")},playChangePosition:function(){clearTimeout(this.playChangeFlag);this.out.offsetLeft,this.out.clientWidth;var e=this.$refs.transparentProgess.offsetWidth;this.$refs.dragCircle.style.left="calc(".concat(this.video.currentTime/this.video.duration*100,"% - 0.5rem)"),this.$refs.whiteProgess.style.width=e*this.video.currentTime/this.video.duration+"px",this.currentTime=isNaN(this.video.currentTime)?"00:00:00":parseInt(this.video.currentTime/3600)+" : "+parseInt(this.video.currentTime/60)+" : "+parseInt(this.video.currentTime%60),this.playChangeFlag=setTimeout(this.playChangePosition,250)},changeColumnCircle:function(){document.addEventListener("mousemove",this.volumePosition)},volumePosition:function(){var e=this.$refs.columnCircle,t=this.$refs.columnTransparent,s=this.$refs.columnWhite,i=t.getBoundingClientRect().height-(event.clientY-t.getBoundingClientRect().top);if(i>0&&i<t.getBoundingClientRect().height-8){e.style.bottom=i+"px",s.style.height=i+"px";var n=.01*parseInt(i/(t.getBoundingClientRect().height-8)*100);this.video.volume=n<.05?0:n}},stopVolumePosition:function(){document.removeEventListener("mousemove",this.volumePosition)}},mounted:function(){this.video=this.$refs.video,this.out=this.$refs.out,this.$refs.dragCircle.style.left="calc(0% - 0.5rem)",this.$refs.whiteProgess.style.width="0",this.$refs.columnCircle.style.bottom="20%",this.$refs.columnWhite.style.height="calc(20% + 0.5rem)",this.video.volume=.2},beforeDestroy:function(){clearTimeout(this.playChangeFlag),this.$http.post("addHistory",{currentTime:parseInt(this.video.currentTime),movieid:this.movieid}).catch((function(e){console.log(e.message)}))}};t.default=i},209:function(e,t,s){},210:function(e,t,s){},223:function(e,t,s){"use strict";s.r(t);var i=s(237),n=s(207);for(var o in n)"default"!==o&&function(e){s.d(t,e,(function(){return n[e]}))}(o);s(224);var r=s(51),a=Object(r.a)(n.default,i.a,i.b,!1,null,"aa517948",null);a.options.__file="components/player.vue",t.default=a.exports},224:function(e,t,s){"use strict";var i=s(209);s.n(i).a},225:function(e,t,s){"use strict";var i=s(210);s.n(i).a},233:function(e,t,s){"use strict";s.d(t,"a",(function(){return i})),s.d(t,"b",(function(){return n}));var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[e.playerShow?s("player",{attrs:{movieid:e.movie.id,historyCurrentTime:e.currentTime,moviesource:e.movie.moviesource}}):s("div",{staticClass:"movie"},[s("el-image",{staticStyle:{width:"20%",height:"100%"},attrs:{src:e.imgurl,fit:"fill"}}),e._v(" "),s("div",{staticClass:"rigntBox"},[s("div",{staticClass:"nameIntro"},[s("div",[e._v(e._s(e.movie.moviename))]),e._v(" "),s("div",[e._v("介绍："+e._s(e.movie.introduction))])]),e._v(" "),s("div",{staticClass:"playRate"},[s("el-button",{staticStyle:{width:"200px",height:"100%"},attrs:{type:"success"},on:{click:function(t){e.playerShow?e.playerShow=!1:e.playerShow=!0}}},[e._v("开始播放")]),e._v(" "),s("el-rate",{attrs:{disabled:"","show-score":"","text-color":"#ff9900","score-template":"{value}"},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}})],1)])],1),e._v(" "),e.showComment?s("div",{staticClass:"commentModule"},[s("div",{staticClass:"wirteComment"},[s("el-input",{attrs:{type:"textarea",autosize:{minRows:3},resize:"none",placeholder:"请输入评论内容"},model:{value:e.commentInput,callback:function(t){e.commentInput=t},expression:"commentInput"}}),e._v(" "),s("div",{staticStyle:{"margin-top":"10px","text-align":"right"}},[s("el-button",{attrs:{type:"primary"},on:{click:e.publishComment}},[e._v("发表评论")])],1)],1),e._v(" "),e._l(e.comments,(function(t,i){return s("div",{key:t.commentid,staticClass:"comment"},[s("div",{staticClass:"commentUserInfo"},[s("el-image",{staticStyle:{width:"50px",height:"50px","vertical-align":"middle","border-radius":"50%"},attrs:{src:e.$store.state.sourcePath+t.photo,fit:"fill"}}),e._v(" "),s("span",[e._v(e._s(t.nickname))])],1),e._v(" "),s("div",{staticClass:"commentConetnt"},[e._v(e._s(t.content))]),e._v(" "),s("div",{staticStyle:{"text-align":"right","font-size":"16px"}},[s("svg",{ref:"svgArr",refInFor:!0,class:["icon",t.havedianzhan?"orangeColor":""],attrs:{"aria-hidden":"true"},on:{click:function(s){return e.dianzhan(i,t.havedianzhan,t)}}},[s("use",{attrs:{"xlink:href":"#icon-dianzan"}})]),e._v(" "),s("span",[e._v(e._s(t.good))])])])})),e._v(" "),e.commentLength>0?s("div",{staticClass:"pagination"},[s("el-pagination",{attrs:{background:"",layout:"prev,pager,next","page-size":10,"current-page":e.whichPage,total:e.commentLength},on:{"update:currentPage":function(t){e.whichPage=t},"update:current-page":function(t){e.whichPage=t},"current-change":e.getCommentInfo}})],1):e._e(),e._v(" "),0==e.commentLength?s("div",{staticClass:"nocomment"},[e._v("\n      暂无评论，快来发表吧(*^▽^*)\n    ")]):e._e()],2):e._e()],1)},n=[];i._withStripped=!0},237:function(e,t,s){"use strict";s.d(t,"a",(function(){return i})),s.d(t,"b",(function(){return n}));var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{ref:"out",staticClass:"out",attrs:{id:"videobox"},on:{mousemove:e.controlShow}},[s("div",{directives:[{name:"show",rawName:"v-show",value:e.lastCurrentTime,expression:"lastCurrentTime"}],staticClass:"lastCurrentTime"},[s("span",{on:{click:e.gotoLastTime}},[e._v("返回上次播放位置"+e._s(parseInt(e.historyCurrentTime/3600)+" : "+parseInt(e.historyCurrentTime%3600/60)+" : "+parseInt(e.historyCurrentTime%60)))]),e._v(" "),s("span",[s("i",{staticClass:"el-icon-close",on:{click:function(t){e.lastCurrentTime=!1}}})])]),e._v(" "),s("transition",{attrs:{name:"toolTransition"}},[s("div",{directives:[{name:"show",rawName:"v-show",value:e.showTool,expression:"showTool"}],ref:"tool",staticClass:"tool"},[e.ispaused?s("i",{staticClass:"el-icon-video-play playButton button",on:{"~click":function(t){return e.showLastCurrentTime(t)},click:function(t){return t.stopPropagation(),e.play()}}}):s("i",{staticClass:"el-icon-video-pause playButton button",on:{click:function(t){return t.stopPropagation(),e.play()}}}),e._v(" "),s("i",{staticClass:"el-icon-rank enlargeButton button",on:{click:function(t){return t.stopPropagation(),e.enlarge()}}}),e._v(" "),s("div",{ref:"volumnOut",staticClass:"volumn button",on:{mouseleave:e.stopVolumePosition,mouseup:e.stopVolumePosition,click:function(e){e.stopPropagation()}}},[s("transition",{attrs:{name:"volumn"}},[s("div",{directives:[{name:"show",rawName:"v-show",value:e.showVolumn,expression:"showVolumn"}],staticClass:"volumnInner",on:{mouseenter:function(t){e.showVolumn=!0},mouseleave:function(t){e.showVolumn=!1}}},[s("div",{ref:"columnTransparent",staticClass:"columnTransparent"}),e._v(" "),s("div",{ref:"columnWhite",staticClass:"columnWhite"}),e._v(" "),s("div",{ref:"columnCircle",staticClass:"columnCircle",on:{mousedown:e.changeColumnCircle}})])])],1),e._v(" "),s("svg",{staticClass:"button icon laba",attrs:{"aria-hidden":"true"},on:{mouseenter:function(t){e.showVolumn=!0},mouseleave:function(t){e.showVolumn=!1},click:function(e){e.stopPropagation()}}},[s("use",{attrs:{"xlink:href":"#icon-laba"}})]),e._v(" "),e.video?s("div",{ref:"currentTime",staticClass:"currentTime"},[e._v(e._s(e.currentTime))]):e._e(),e._v(" "),s("div",{ref:"progress",staticClass:"progress",on:{mouseup:e.stopChangeProgress,click:function(e){e.stopPropagation()}}},[s("div",{ref:"transparentProgess",staticClass:"transparentProgess"}),e._v(" "),s("div",{ref:"whiteProgess",staticClass:"whiteProgess"}),e._v(" "),s("div",{ref:"dragCircle",staticClass:"dragCircle",on:{mousedown:e.changeProgress}})]),e._v(" "),e.video?s("div",{ref:"duration",staticClass:"duration"},[e._v(e._s(isNaN(e.video.duration)?"00:00:00":parseInt(e.video.duration/3600)+" : "+parseInt(e.video.duration%3600/60)+" : "+e.video.duration%60))]):e._e()])]),e._v(" "),s("video",{ref:"video",staticClass:"video"},[s("source",{attrs:{src:e.$store.state.moviePath+e.moviesource,type:"video/mp4"}})])],1)},n=[];i._withStripped=!0}}]);